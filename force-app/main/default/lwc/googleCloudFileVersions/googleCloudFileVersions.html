<template>
    <c-google-cloud-base-card title="File Versions" icon-name="utility:file" badge-text={badgeText}>
        <div class="version-list__body">
            <ul class="version-list__rows">
                <template for:each={allVersions} for:item="version">
                    <li key={version.id} data-id={version.id} class="version-list__row">
                        <button type="button" class="slds-button slds-button_reset version-row-button" onclick={handleVersionClick}>
                            <div class="version-row__date">
                                <div class="version-row__date-day slds-truncate"
                                     title={version.createdDateLabel}>
                                    {version.createdDateLabel}
                                </div>
                                <div class="version-row__date-time slds-truncate"
                                     title={version.createdTimeLabel}>
                                    {version.createdTimeLabel}
                                </div>
                            </div>
                            <div class="version-row__main">
                                <div class="version-row__title slds-truncate" title={version.name}>
                                    {version.name}
                                </div>

                                <div class="version-row__meta slds-truncate" title={version.meta}>
                                    {version.meta}
                                </div>

                                <template lwc:if={version.hasWarning}>
                                    <div class="version-row__warning" title="This version contains a public link. For security, consider removing it">
                                        <span>This version contains a public link. For security, consider removing it</span>
                                    </div>
                                </template>
                            </div>
                        </button>
                    </li>
                </template>
            </ul>
            
            <lightning-spinner 
                lwc:if={isLoading}
                alternative-text="Loading"
                size="small">
            </lightning-spinner>
        </div>
        <c-google-cloud-file-preview
            lwc:ref="filePreviewModal"
            onnewversionupload={handleNewVersionUpload}
            onfilechange={handleFileEdit}
            onfiledeleted={handleFileDelete}
        ></c-google-cloud-file-preview>
    </c-google-cloud-base-card>
</template>